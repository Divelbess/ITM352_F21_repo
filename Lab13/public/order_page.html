<!DOCTYPE html>
<html lang="en">

<head>
    <script src="./product_data.js"></script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
                let params = (new URL(document.location)).searchParams;
                function isNonNegInt(q, returnErrors = false) {
        errors = [];
        if(q == '') q=0;
        if (Number(q) != q) errors.push('Not a number!');
        else{

      
        if (q < 0) errors.push('Negative value!');
        if (parseInt(q) != q) errors.push('Not an integer!'); 
    }
        return returnErrors ? errors : (errors.length == 0) 
    }
        var q = params.get('quantity');
        let brand = products[0]['brand'];
let brand_price = products[0]['price'];
    if(params.has('error')){
        document.write(params.get('error'));
    }
    if (params.has('quantity')) {
        if(isNonNegInt(q)){
           // products[0].total_sold += Number(q);
    document.write(`<h2>Thank you for purchasing ${q} ${brand}. Your total is \$${q * brand_price}!</h2>`);
} 
    window.stop();
    } 
            for (i in products) {
        document.write(`<h4>${products[i]["total_sold"]} ${products[i]["brand"]} have been sold!</h4>`);
    }
        document.write(`<h3>${products[0]["brand"]} at \$${products[0]["price"]}</h3>`);
    </script>
    <form name="quantity_form" action="./process_form" method="POST">
    <label>quantity desired:</label>
    <input name="quantity_textbox" type="text" 
    onkeyup="checkQuantityTextbox(this);">

    <span id='qty_textbox_message'>Enter a quantity</span>
    <br>
    <input name="purchase_submit_button" type="submit" value="Purchase" ></form>
</body>


</html>
<script>
        function checkQuantityTextbox(theTextbox, theMsgSpan) {
        // is the textboxvalue a non-neg int?
                var errors_array=isNonNegInt(theTextbox.value, true);
                theMsgSpan.innerHTML = errors_array.join(' ');

    }
   
    function displayPurchase() {
        var qty = quantity_textbox.value;
        var err=isNonNegInt(qty, true );
        if(err.length ==0){
        document.write(`Thank you for ordering ${qty} things!`);
}    
    else{
        qty_textbox_message.innerHTML =`<font color ="red">${err.join('')} Enter a valid quantity </font>`;
    }
}


</script>
<script>

</script>